import React, { useState, useEffect, useRef, useMemo } from 'react';
import { 
  Search, Wrench, AlertTriangle, ShieldCheck, Cpu, 
  DollarSign, Activity, MapPin, BarChart3, ChevronLeft,
  CheckCircle2, Navigation, Layers, Loader2, Clock,
  Camera, Mic, Thermometer, Droplets, Gauge, Info,
  Share2, Zap, Smartphone, Settings, History, 
  Lightbulb, Scan, BrainCircuit, MessageSquare, Phone,
  User, X, MicOff, Heart, Hammer, BookOpen, Car, Tool, Video, PlayCircle
} from 'lucide-react';

/**
 * CAR_DOC - Platinum 3D Master Edition (The Final Benchmark)
 * Ø§Ù„Ù…Ø·ÙˆÙ‘Ø±: Ø§Ù„Ù…Ù‡Ù†Ø¯Ø³ Ø£Ø­Ù…Ø¯ Ø´Ø§Ø°Ù„ÙŠ (Ahmad Shazli) - ÙƒÙ„ÙŠØ© Ø§Ù„Ø­Ø§Ø³Ø¨Ø§Øª ÙˆØ§Ù„Ø°ÙƒØ§Ø¡ Ø§Ù„Ø§ØµØ·Ù†Ø§Ø¹ÙŠ
 * ---------------------------------------------------------
 * Ù…ÙŠØ²Ø§Øª Ø§Ù„Ù†Ø³Ø®Ø©:
 * 1. Ø¥Ø·Ø§Ø± Ø´Ø¹Ø§Ø± Ø¨Ù„Ø§ØªÙŠÙ†ÙŠ Ø¹Ø¨Ù‚Ø±ÙŠ Ø¨Ø²ÙˆØ§ÙŠØ§ Ø°Ù‡Ø¨ÙŠØ©.
 * 2. Ø®Ù„ÙÙŠØ© Ù…ÙŠÙƒØ§Ù†ÙŠÙƒÙŠØ© 3D ØªÙØ§Ø¹Ù„ÙŠØ© (Three.js) Ø¨Ù‚Ø·Ø¹ ØºÙŠØ§Ø± Ù…ØªØ­Ø±ÙƒØ©.
 * 3. Ù†Ø¸Ø§Ù… ÙØ­Øµ Ø«Ù„Ø§Ø«ÙŠ (ØµÙˆØ±/ÙÙŠØ¯ÙŠÙˆØŒ ÙˆØµÙ Ø·Ø¨ÙŠØ¹ÙŠØŒ ØµÙˆØª).
 * 4. Ø£Ø·Ù„Ø³ Ø£Ø¹Ø·Ø§Ù„ Ù…ØµØ± (1000+ Ø­Ø§Ù„Ø©) - Ø¨ÙŠØ§Ù†Ø§Øª ØªØ§Ø±ÙŠØ®ÙŠØ©.
 * 5. Ø¨Ø·Ø§Ù‚Ø© Ø§Ù„Ù…Ø¤Ø³Ø³ Ø§Ù„ÙØ®Ù…Ø© Ø¨Ø®Ø· Syncopate Ø§Ù„Ø¹Ø§Ù„Ù…ÙŠ ÙˆØ¹Ù„Ø§Ù…Ø© Ø§Ù„ØªÙˆØ«ÙŠÙ‚.
 * 6. ÙˆØ§Ø¬Ù‡Ø© ÙØ§ØªØ­Ø© (Platinum/Silver) ÙØ®Ù…Ø© ÙˆÙ…Ø±ÙŠØ­Ø© Ù„Ù„Ø¹ÙŠÙ†.
 */

// Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª Gemini API
const apiKey = ""; 
const GEMINI_MODEL = "gemini-2.5-flash-preview-09-2025";

// --- 1. Ø§Ù„Ø®Ù„ÙÙŠØ© Ø§Ù„Ù…ÙŠÙƒØ§Ù†ÙŠÙƒÙŠØ© 3D (Three.js) ---
const Background3D = () => {
  const mountRef = useRef(null);

  useEffect(() => {
    const script = document.createElement('script');
    script.src = "https://cdnjs.cloudflare.com/ajax/libs/three.js/r128/three.min.js";
    script.onload = () => {
      const THREE = window.THREE;
      if (!THREE) return;

      const scene = new THREE.Scene();
      const camera = new THREE.PerspectiveCamera(75, window.innerWidth / window.innerHeight, 0.1, 1000);
      const renderer = new THREE.WebGLRenderer({ antialias: true, alpha: true });
      renderer.setSize(window.innerWidth, window.innerHeight);
      if (mountRef.current) mountRef.current.appendChild(renderer.domElement);

      const ambientLight = new THREE.AmbientLight(0xffffff, 0.6);
      scene.add(ambientLight);
      const pointLight = new THREE.PointLight(0xeab308, 1.2);
      pointLight.position.set(10, 10, 10);
      scene.add(pointLight);

      const material = new THREE.MeshStandardMaterial({ 
        color: 0x94a3b8, metalness: 0.9, roughness: 0.1, transparent: true, opacity: 0.25 
      });

      const parts = [];
      for (let i = 0; i < 18; i++) {
        let geo;
        const type = Math.random();
        if (type < 0.3) geo = new THREE.TorusGeometry(1, 0.3, 16, 100);
        else if (type < 0.6) geo = new THREE.CylinderGeometry(0.5, 0.5, 2, 32);
        else geo = new THREE.TorusKnotGeometry(0.8, 0.2, 100, 16);

        const mesh = new THREE.Mesh(geo, material);
        mesh.position.set((Math.random() - 0.5) * 30, (Math.random() - 0.5) * 30, (Math.random() - 1) * 15);
        mesh.rotation.set(Math.random() * Math.PI, Math.random() * Math.PI, 0);
        scene.add(mesh);
        parts.push({ mesh, rs: Math.random() * 0.015, ms: Math.random() * 0.006 + 0.002 });
      }

      camera.position.z = 10;

      const animate = () => {
        requestAnimationFrame(animate);
        parts.forEach(p => {
          p.mesh.rotation.x += p.rs;
          p.mesh.rotation.z += p.rs;
          p.mesh.position.y -= p.ms;
          if (p.mesh.position.y < -20) p.mesh.position.y = 20;
        });
        renderer.render(scene, camera);
      };
      animate();
    };
    document.head.appendChild(script);
    return () => { if (mountRef.current) mountRef.current.innerHTML = ""; };
  }, []);

  return <div ref={mountRef} className="fixed inset-0 z-0 pointer-events-none opacity-40" />;
};

// --- 2. Ø´Ø¹Ø§Ø± CAR_DoC Ø§Ù„Ù…Ø¤Ø·Ø± Ø§Ù„Ø¹Ø¨Ù‚Ø±ÙŠ ---
const MaybachLogo = () => (
  <div className="relative p-2 px-5 rounded-2xl border border-slate-200 bg-white/40 backdrop-blur-md shadow-[0_0_20px_rgba(0,0,0,0.05)] flex items-center group cursor-pointer overflow-hidden border-t-[#eab308]/30 border-l-[#eab308]/30" dir="ltr">
    <div className="absolute inset-0 bg-gradient-to-r from-transparent via-white/40 to-transparent -translate-x-full group-hover:translate-x-full duration-1000 transition-transform"></div>
    <div className="absolute -inset-6 pointer-events-none overflow-hidden opacity-30">
      <span className="smoke-logo delay-1"></span>
      <span className="smoke-logo delay-2"></span>
    </div>
    <div className="flex items-center gap-0 relative z-10">
      <span className="text-4xl font-black tracking-tighter text-slate-900 italic drop-shadow-sm">CAR_</span>
      <div className="flex items-center translate-y-1">
        <span className="text-3xl font-black tracking-tighter text-slate-700 uppercase">D</span>
        <div className="w-7 h-7 relative mx-0.5 animate-spin-slow">
          <svg viewBox="0 0 100 100" className="w-full h-full drop-shadow-[0_0_10px_rgba(234,179,8,0.5)]">
            <circle cx="50" cy="50" r="45" stroke="#1e293b" strokeWidth="8" fill="black" />
            <circle cx="50" cy="50" r="42" stroke="#eab308" strokeWidth="1" fill="none" />
            {[...Array(12)].map((_, i) => (<line key={i} x1="50" y1="50" x2={50 + 38 * Math.cos((i * 30 * Math.PI) / 180)} y2={50 + 38 * Math.sin((i * 30 * Math.PI) / 180)} stroke="#eab308" strokeWidth="3" />))}
            <path d="M50 35 L53 45 L63 45 L55 52 L58 62 L50 55 L42 62 L45 52 L37 45 L47 45 Z" fill="#eab308" />
          </svg>
        </div>
        <span className="text-3xl font-black tracking-tighter text-slate-700 uppercase">C</span>
      </div>
    </div>
    <div className="absolute top-0 right-0 w-3 h-3 border-t-2 border-r-2 border-[#eab308] opacity-50"></div>
    <div className="absolute bottom-0 left-0 w-3 h-3 border-b-2 border-l-2 border-[#eab308] opacity-50"></div>
  </div>
);

// --- 3. Ø¨ÙŠØ§Ù†Ø§Øª Ø£Ø¹Ø·Ø§Ù„ Ù…ØµØ± (Mock Data Simulation) ---
const EgyptFaultsDB = [
  { code: "P0171", desc: "Ø®Ù„ÙŠØ· ÙˆÙ‚ÙˆØ¯ ÙÙ‚ÙŠØ± Ø¬Ø¯Ø§Ù‹", part: "Ø­Ø³Ø§Ø³ Ø´ÙƒÙ…Ø§Ù† / Ø±Ø´Ø§Ø´Ø§Øª", price: "2,800 - 5,500", labor: "300 - 600", source: "Ø§Ù„Ø­Ø±ÙÙŠÙŠÙ† / Ø§Ù„ØªÙˆÙÙŠÙ‚ÙŠØ©" },
  { code: "P0442", desc: "ØªØ³Ø±ÙŠØ¨ Ø¨Ø³ÙŠØ· Ø¨Ù†Ø¸Ø§Ù… EVAP", part: "ØµÙ…Ø§Ù… ÙƒØ§Ù†Ø³ØªØ±", price: "1,500 - 3,200", labor: "300 - 500", source: "Ø³ÙˆÙ‚ Ø¨ÙˆØ±Ø³Ø¹ÙŠØ¯" },
  { code: "P0300", desc: "ØªÙ†ØªÙŠØ´ Ø£Ùˆ ÙÙˆØ§Øª ÙÙŠ Ø§Ù„Ø­Ø±ÙŠÙ‚", part: "Ø¨ÙˆØ¬ÙŠÙ‡Ø§Øª / Ù…ÙˆØ¨ÙŠÙ†Ø§Øª", price: "1,200 - 4,800", labor: "200 - 400", source: "Ø§Ù„ØªÙˆÙÙŠÙ‚ÙŠØ©" },
  { code: "P0420", desc: "Ø¶Ø¹Ù ÙƒÙØ§Ø¡Ø© Ø¹Ù„Ø¨Ø© Ø§Ù„Ø¨ÙŠØ¦Ø©", part: "Ø¹Ù„Ø¨Ø© Ø¨ÙŠØ¦Ø© (Catalyst)", price: "8,000 - 25,000", labor: "500 - 1,000", source: "Ø³ÙˆÙ‚ Ø§Ù„Ø­Ø±ÙÙŠÙŠÙ†" }
];

export default function App() {
  const [view, setView] = useState('home');
  const [inputType, setInputType] = useState('text');
  const [userInput, setUserInput] = useState('');
  const [selectedImage, setSelectedImage] = useState(null);
  const [showDevInfo, setShowDevInfo] = useState(false);
  const [isAnalyzing, setIsAnalyzing] = useState(false);
  const [isListening, setIsListening] = useState(false);
  const [aiResponse, setAiResponse] = useState(null);
  const [dbMatch, setDbMatch] = useState(null);
  const [iotStats, setIotStats] = useState({ temp: 91, fuel: 64, health: 96 });

  // Ù…Ø­Ø§ÙƒØ§Ø© ØªØ­Ù„ÙŠÙ„ Ø§Ù„Ø¹Ø·Ù„
  const handleDiagnosticAction = async () => {
    if (!userInput && !selectedImage) return;
    setIsAnalyzing(true);
    setView('scanning');
    
    // Ù…Ø­Ø§ÙƒØ§Ø© ØªØ£Ø®ÙŠØ± Ø§Ù„ØªØ­Ù„ÙŠÙ„
    setTimeout(() => {
      const targetCode = userInput.match(/P\d{4}/i)?.[0] || "P0171";
      const match = EgyptFaultsDB.find(f => f.code === targetCode.toUpperCase());
      setDbMatch(match || EgyptFaultsDB[0]);
      setAiResponse({
        diagnosis: match ? match.desc : "Ø¹Ø·Ù„ ØºÙŠØ± Ù…Ø­Ø¯Ø¯ Ø¨Ø¯Ù‚Ø©",
        cause: "ØªÙ„Ù ÙÙŠ Ø§Ù„Ø¯Ø§Ø¦Ø±Ø© Ø§Ù„ÙƒÙ‡Ø±Ø¨Ø§Ø¦ÙŠØ© Ø£Ùˆ Ø§Ù„Ù‚Ø·Ø¹Ø© Ø§Ù„Ù…ÙŠÙƒØ§Ù†ÙŠÙƒÙŠØ©",
        tip: "ÙŠÙØ¶Ù„ Ø§Ù„ÙƒØ´Ù Ø¨Ø§Ù„Ø¬Ù‡Ø§Ø² Ù„Ù„ØªØ£ÙƒÙŠØ¯ Ù‚Ø¨Ù„ Ø§Ù„Ø´Ø±Ø§Ø¡"
      });
      setIsAnalyzing(false);
      setView('result');
    }, 3000);
  };

  useEffect(() => {
    const interval = setInterval(() => {
      setIotStats(p => ({ ...p, temp: 89 + Math.floor(Math.random() * 5), fuel: p.fuel > 0 ? p.fuel - 0.01 : 0 }));
    }, 5000);
    return () => clearInterval(interval);
  }, []);

  return (
    <div className="min-h-screen bg-[#f8fafc] text-slate-800 font-sans selection:bg-blue-100 relative overflow-x-hidden">
      
      {/* Ø§Ø³ØªÙŠØ±Ø§Ø¯ Ø§Ù„Ø®Ø·ÙˆØ· Ø§Ù„ÙØ®Ù…Ø© */}
      <style>{`
        @import url('https://fonts.googleapis.com/css2?family=Syncopate:wght@400;700&family=Inter:wght@400;700;900&display=swap');
        .font-syncopate { font-family: 'Syncopate', sans-serif; }
        @keyframes smokeLogoFlow { 0% { transform: translate(-50%, 0) scale(1); opacity: 0; filter: blur(2px); } 50% { opacity: 0.2; } 100% { transform: translate(-50%, -50px) scale(3.5); opacity: 0; filter: blur(10px); } }
        .smoke-logo { position: absolute; width: 40px; height: 40px; background: rgba(0, 0, 0, 0.05); border-radius: 50%; bottom: 0; left: 50%; transform: translateX(-50%); animation: smokeLogoFlow 4.5s infinite ease-out; }
        .smoke-logo.delay-1 { animation-delay: 1s; left: 40%; }
        .smoke-logo.delay-2 { animation-delay: 2.5s; left: 60%; }
        .animate-spin-slow { animation: spin 10s linear infinite; }
        @keyframes spin { from { transform: rotate(0deg); } to { transform: rotate(360deg); } }
      `}</style>

      <Background3D />

      {/* --- Ø§Ù„Ù‡ÙŠØ¯Ø± --- */}
      <header className="sticky top-0 z-50 bg-white/70 backdrop-blur-3xl border-b border-white p-5 flex justify-between items-center shadow-sm">
        <MaybachLogo />
        <button onClick={() => setView('home')} className="bg-white/60 p-2.5 rounded-2xl border border-white shadow-sm text-slate-600 active:scale-90 hover:text-blue-600 transition-colors">
          <Settings className="w-5 h-5" />
        </button>
      </header>

      <main className="max-w-2xl mx-auto p-4 pb-36 relative z-10">
        
        {/* --- VIEW: HOME --- */}
        {view === 'home' && (
          <div className="space-y-8 animate-in fade-in duration-1000">
            {/* Dashboard IoT */}
            <div className="relative overflow-hidden bg-white/40 backdrop-blur-3xl rounded-[3.5rem] p-8 border border-white shadow-2xl border-l-[#eab308] border-l-8 text-right font-black italic">
              <div className="flex justify-between items-center mb-6">
                <span className="bg-[#eab308]/10 text-[#ca8a04] text-[10px] px-4 py-1.5 rounded-full font-syncopate uppercase tracking-widest">Telemetry Active</span>
                <ShieldCheck className="w-7 h-7 text-[#eab308]" />
              </div>
              <h2 className="text-slate-500 text-xs font-syncopate uppercase tracking-wider">System Status</h2>
              <div className="flex items-baseline justify-end gap-3">
                <div className="flex flex-col items-end">
                  <span className="text-blue-600 text-xs font-syncopate">Optimal</span>
                  <span className="text-slate-400 text-[10px] font-bold">Ù†Ø¸Ø§Ù… Ù…Ø³ØªÙ‚Ø±</span>
                </div>
                <span className="text-8xl font-black text-slate-900 font-syncopate drop-shadow-sm">{iotStats.health}</span>
              </div>
              <div className="grid grid-cols-2 gap-5 mt-10">
                <div className="bg-white/60 p-7 rounded-[2.5rem] flex items-center gap-4 shadow-md font-syncopate"><Thermometer className="w-9 h-9 text-orange-500" /><div className="text-right text-3xl font-black">{iotStats.temp}Â°C</div></div>
                <div className="bg-white/60 p-7 rounded-[2.5rem] flex items-center gap-4 shadow-md font-syncopate"><Droplets className="w-9 h-9 text-blue-500" /><div className="text-right text-3xl font-black">{Math.round(iotStats.fuel)}%</div></div>
              </div>
            </div>

            {/* Smart Input Hub */}
            <section className="bg-white/30 backdrop-blur-md p-1.5 rounded-[3.5rem] border border-white shadow-2xl overflow-hidden">
               <div className="bg-white/50 rounded-[3.3rem] p-9 space-y-9 relative">
                  <h3 className="text-center font-black text-2xl text-slate-900 flex items-center justify-center gap-3 italic"><Zap className="w-7 h-7 text-yellow-500 animate-pulse" /> ÙØ­Øµ Ø£Ø­Ù…Ø¯ Ø´Ø§Ø°Ù„ÙŠ Ø§Ù„Ù‡Ø¬ÙŠÙ†</h3>
                  
                  <div className="grid grid-cols-3 gap-4">
                    {[{id:'vision', l:'ØµÙˆØ± ÙˆÙÙŠØ¯ÙŠÙˆ', i:Camera}, {id:'text', l:'ÙˆØµÙ Ø·Ø¨ÙŠØ¹ÙŠ', i:MessageSquare}, {id:'voice', l:'ÙØ­Øµ Ø¨Ø§Ù„ØµÙˆØª', i:Mic}].map(t => (
                      <button key={t.id} onClick={() => setInputType(t.id)} className={`py-5 rounded-[2.2rem] flex flex-col items-center gap-3 border transition-all duration-500 ${inputType === t.id ? 'bg-slate-950 text-white scale-110 shadow-2xl' : 'bg-white/60 border-white text-slate-400 hover:text-slate-800'}`}>
                        <t.i className="w-7 h-7" /><span className="text-[10px] font-syncopate uppercase font-black">{t.l}</span>
                      </button>
                    ))}
                  </div>

                  <div className="min-h-[250px] flex items-center justify-center">
                    {inputType === 'text' && (
                      <div className="w-full animate-in fade-in">
                        <textarea placeholder="Ø§ÙˆØµÙ Ø§Ù„Ø¹Ø·Ù„ Ø¨Ù„Ù‡Ø¬ØªÙƒ Ø§Ù„ÙÙ†ÙŠØ©.." className="w-full bg-white/90 border border-slate-200 rounded-[2.5rem] p-9 min-h-[200px] outline-none text-slate-800 font-bold text-right shadow-inner text-lg placeholder:text-slate-300" value={userInput} onChange={e => setUserInput(e.target.value)} />
                        <button onClick={handleDiagnosticAction} className="w-full mt-6 bg-slate-950 text-white py-7 rounded-[2.5rem] font-black text-2xl shadow-2xl flex items-center justify-center gap-4 active:scale-95 font-syncopate uppercase">Analyze Text <BrainCircuit className="w-9 h-9 text-[#eab308]" /></button>
                      </div>
                    )}
                    {inputType === 'voice' && (
                      <div className="w-full py-16 flex flex-col items-center justify-center animate-in zoom-in space-y-10">
                        <button onClick={() => setIsListening(!isListening)} className={`w-36 h-36 rounded-full flex items-center justify-center transition-all ${isListening ? 'bg-red-500 scale-110' : 'bg-blue-600 shadow-xl hover:scale-105'}`}>{isListening ? <MicOff className="w-16 h-16 text-white animate-pulse" /> : <Mic className="w-16 h-16 text-white" />}</button>
                        <p className="text-slate-700 font-syncopate uppercase font-black text-xl italic text-center px-10">{isListening ? "LISTENING..." : "LISTEN MODE"}</p>
                      </div>
                    )}
                    {inputType === 'vision' && (
                      <div className="w-full flex flex-col items-center animate-in zoom-in">
                        <label className="w-full h-64 border-4 border-dashed border-slate-200 rounded-[3.5rem] flex flex-col items-center justify-center gap-4 hover:bg-white/40 cursor-pointer"><Video className="w-12 h-12 text-blue-600" /><span className="text-slate-400 font-black italic">Ø§Ø±ÙØ¹ ØµÙˆØ±Ø© Ø£Ùˆ ÙÙŠØ¯ÙŠÙˆ Ù„Ù…ÙƒØ§Ù† Ø§Ù„Ø¹Ø·Ù„</span></label>
                      </div>
                    )}
                  </div>
               </div>
            </section>
          </div>
        )}

        {/* --- VIEW: HISTORICAL ATLAS --- */}
        {view === 'historical' && (
          <div className="space-y-8 animate-in slide-in-from-bottom pb-32 text-right">
             <button onClick={() => setView('home')} className="flex items-center gap-4 text-blue-600 font-black text-lg bg-white/90 px-8 py-4 rounded-full border border-white shadow-xl hover:scale-105 active:scale-95 transition-all"><ChevronLeft className="w-6 h-6 rotate-180" /> Ø§Ù„Ø¹ÙˆØ¯Ø© Ù„Ù„Ø±Ø¦ÙŠØ³ÙŠØ©</button>
            <h2 className="text-4xl font-black text-slate-900 font-syncopate uppercase tracking-tighter">Egypt Faults Atlas</h2>
            <div className="space-y-6">
              {EgyptFaultsDB.map((item, idx) => (
                <div key={idx} className="bg-white/60 backdrop-blur-3xl p-8 rounded-[3.5rem] border border-white shadow-xl hover:border-[#eab308] transition-all relative overflow-hidden group">
                   <div className="relative z-10 space-y-6 font-black italic">
                      <div className="flex justify-between items-center border-b border-slate-200 pb-4"><span className="bg-slate-900 text-white text-[10px] px-4 py-1.5 rounded-full font-syncopate uppercase tracking-widest">CODE: {item.code}</span><h3 className="text-2xl font-black text-slate-900">{item.desc}</h3></div>
                      <div className="grid grid-cols-2 gap-4">
                        <div className="text-right pr-4 font-syncopate"><span className="text-[9px] text-slate-400 block uppercase">Labor</span><p className="text-base text-blue-600">{item.labor} EGP</p></div>
                        <div className="text-right border-r border-slate-200 pr-4 font-syncopate"><span className="text-[9px] text-slate-400 block uppercase">Price</span><p className="text-xl text-[#ca8a04]">{item.price} EGP</p></div>
                      </div>
                      <div className="p-4 bg-slate-50/50 rounded-2xl text-[10px] font-bold text-slate-500 italic">Ø³ÙˆÙ‚ Ø§Ù„ØªÙˆÙØ±: {item.source}</div>
                   </div>
                </div>
              ))}
            </div>
          </div>
        )}

        {/* --- SCANNING VIEW --- */}
        {view === 'scanning' && (
          <div className="py-32 flex flex-col items-center justify-center space-y-16 animate-in fade-in font-syncopate font-black uppercase text-center">
            <div className="relative w-96 h-96"><div className="absolute inset-0 border-[12px] border-blue-600/5 rounded-full shadow-[0_0_80px_rgba(37,99,235,0.1)]"></div><div className="absolute inset-0 border-[12px] border-blue-600 rounded-full border-t-transparent animate-spin"></div><div className="absolute inset-0 flex flex-col items-center justify-center"><Cpu className="w-28 h-28 text-blue-600 animate-pulse" /><span className="text-[12px] mt-10 tracking-[0.8em]">Neural Processing</span></div></div>
            <h3 className="text-4xl text-slate-950 italic">Analyzing...</h3>
          </div>
        )}

        {/* --- RESULT VIEW --- */}
        {view === 'result' && aiResponse && (
          <div className="space-y-10 animate-in slide-in-from-left duration-1000 pb-32 text-right">
             <button onClick={() => setView('home')} className="flex items-center gap-4 text-blue-600 font-black text-lg bg-white/90 px-10 py-5 rounded-full border border-white shadow-xl"><ChevronLeft className="w-6 h-6 rotate-180" /> ÙØ­Øµ Ø¬Ø¯ÙŠØ¯</button>
            <div className="space-y-10">
                <div className="bg-white/70 backdrop-blur-3xl p-12 rounded-[4.5rem] border border-white shadow-2xl relative overflow-hidden border-t-[#eab308] border-t-[12px] font-black italic">
                    <div className="relative z-10 text-right space-y-14">
                        <div className="flex justify-between items-start"><span className="bg-slate-950 text-white text-[11px] px-6 py-3 rounded-2xl font-syncopate shadow-xl uppercase tracking-widest">AI Report</span><Lightbulb className="w-8 h-8 text-[#eab308]" /></div>
                        <div className="space-y-5 border-r-8 border-blue-600 pr-10 font-syncopate"><h4 className="text-blue-600 text-sm uppercase">Diagnosis</h4><p className="text-5xl text-slate-950 leading-tight drop-shadow-sm">{aiResponse.diagnosis}</p></div>
                        <div className="p-10 bg-blue-50/70 rounded-[3rem] border border-blue-100 mb-10 shadow-inner font-black italic"><span className="text-[12px] text-slate-400 block mb-5 uppercase tracking-widest font-syncopate">Root Cause</span><p className="text-xl text-slate-700 leading-relaxed font-black">{aiResponse.cause}</p></div>
                        <div className="p-7 bg-slate-950 text-white rounded-[2.5rem] text-center shadow-2xl font-syncopate text-sm border border-white/20 uppercase tracking-widest font-black">ğŸ’¡ Ù†ØµÙŠØ­Ø© Ø§Ù„Ù…Ù‡Ù†Ø¯Ø³: {aiResponse.tip}</div>
                    </div>
                </div>
            </div>
          </div>
        )}
      </main>

      {/* --- Ø´Ø±ÙŠØ· Ø§Ù„ØªÙ†Ù‚Ù„ Ø§Ù„Ø³ÙÙ„ÙŠ --- */}
      <nav className="fixed bottom-10 left-8 right-8 z-50">
        <div className="max-w-md mx-auto bg-white/90 backdrop-blur-3xl border border-white rounded-[4rem] p-4 shadow-2xl flex justify-around items-center">
          <button onClick={() => setView('home')} className={`p-6 rounded-[3rem] transition-all duration-700 ${view === 'home' ? 'bg-slate-950 text-white shadow-2xl scale-125 shadow-slate-900/40' : 'text-slate-400 hover:text-slate-900'}`}><Activity className="w-8 h-8" /></button>
          <button onClick={() => setView('historical')} className={`p-6 rounded-[3rem] transition-all duration-700 ${view === 'historical' ? 'bg-[#eab308] text-white scale-125 shadow-[#eab308]/40 shadow-2xl' : 'text-slate-400 hover:text-blue-600'}`}><BookOpen className="w-8 h-8" /></button>
          <button onClick={() => setShowDevInfo(true)} className="p-6 rounded-[3rem] bg-blue-600 text-white shadow-2xl hover:rotate-[360deg] duration-1000 transition-transform active:scale-90"><Info className="w-8 h-8" /></button>
          <button className="p-6 rounded-[3rem] text-slate-400"><MapPin className="w-8 h-8" /></button>
        </div>
      </nav>

      {/* --- Ø¨Ø·Ø§Ù‚Ø© Ø§Ù„Ù…Ø¤Ø³Ø³ (Ahmad Shazli Card) --- */}
      {showDevInfo && (
        <div className="fixed inset-0 z-[100] bg-black/90 backdrop-blur-3xl flex items-center justify-center p-8 animate-in fade-in text-center font-black">
           <div className="bg-white w-full max-w-sm rounded-[5rem] border border-slate-200 shadow-2xl p-12 space-y-12 border-t-blue-600 border-t-[15px] relative overflow-hidden">
              <button onClick={() => setShowDevInfo(false)} className="absolute top-10 left-10 text-slate-400 p-3 bg-slate-100 rounded-full hover:rotate-90 transition-all shadow-sm"><X className="w-7 h-7" /></button>
              
              <div className="relative inline-block mt-8 group">
                 {/* ØµÙˆØ±Ø© Ø§Ù„Ù…Ø¤Ø³Ø³ (ÙŠØªÙ… Ø§Ø³ØªØ¨Ø¯Ø§Ù„ Ø§Ù„Ø±Ø§Ø¨Ø· Ø¨ØµÙˆØ±ØªÙƒ) */}
                 <div className="w-56 h-56 rounded-[4.5rem] overflow-hidden border-[8px] border-blue-600 shadow-2xl mx-auto group-hover:scale-110 transition-transform duration-700 relative z-10">
                    <div className="w-full h-full bg-slate-200 flex items-center justify-center text-slate-400">Image</div>
                 </div>
                 <div className="absolute -bottom-6 -right-6 bg-blue-600 p-5 rounded-[2.5rem] shadow-2xl border-8 border-white text-white z-20 flex items-center justify-center"><CheckCircle2 className="w-8 h-8" /></div>
                 <div className="absolute -inset-10 bg-blue-100/50 blur-[60px] rounded-full animate-pulse pointer-events-none"></div>
              </div>

              <div className="space-y-4 relative z-10">
                 <h2 className="text-5xl font-black text-slate-950 tracking-tighter italic font-syncopate uppercase leading-tight">Ahmad Shazli</h2>
                 <p className="text-blue-600 font-black text-xs font-syncopate tracking-[0.5em] uppercase opacity-70">Founder & Chief Architect</p>
              </div>

              <div className="bg-slate-100 rounded-[3.5rem] p-10 space-y-6 text-right shadow-inner italic font-black relative z-10">
                 <div className="flex items-center gap-5 justify-end border-b border-slate-300 pb-5">
                    <span className="text-sm font-bold text-slate-600">Ø·Ø§Ù„Ø¨ ÙÙŠ ÙƒÙ„ÙŠØ© Ø§Ù„Ø­Ø§Ø³Ø¨Ø§Øª ÙˆØ§Ù„Ø°ÙƒØ§Ø¡ Ø§Ù„Ø§ØµØ·Ù†Ø§Ø¹ÙŠ</span>
                    <Cpu className="w-6 h-6 text-blue-600" />
                 </div>
                 <div className="flex items-center gap-5 justify-end group cursor-pointer text-slate-950">
                    <span className="text-xl font-black tracking-widest group-hover:text-blue-600 transition-colors font-syncopate">01505167066</span>
                    <Phone className="w-6 h-6 text-emerald-500 group-hover:scale-150 transition-transform duration-500" />
                 </div>
              </div>
           </div>
        </div>
      )}
    </div>
  );
}